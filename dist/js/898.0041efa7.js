"use strict";(self["webpackChunklike"]=self["webpackChunklike"]||[]).push([[898],{2348:function(t,e,i){i.d(e,{Z:function(){return u}});var l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[i("el-breadcrumb-item",{attrs:{to:{path:"/stimulate"}}},[t._v("首页")]),i("el-breadcrumb-item",[t._v(t._s(t.label1))]),i("el-breadcrumb-item",[t._v(t._s(t.label2))])],1)],1)},n=[],a={props:["label1","label2"],data(){return{}},methods:{},components:{},computed:{},watch:{},created(){}},s=a,r=i(1001),o=(0,r.Z)(s,l,n,!1,null,"cda8670e",null),u=o.exports},7801:function(t,e,i){i.r(e),i.d(e,{default:function(){return d}});var l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"params"},[i("MBX",{attrs:{label1:"商品管理",label2:"分类参数"}}),i("el-card",[i("el-alert",{attrs:{title:"注意：只允许为第三级分类设置相关参数！",type:"warning","show-icon":"",effect:"dark",closable:!1}}),i("div",{staticClass:"mt"},[t._v(" 选择商品分类 : "),i("el-cascader",{attrs:{options:t.options,props:{expandTrigger:"hover",value:"cat_id",label:"cat_name",children:"children"}},on:{change:t.handleChange},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),i("el-tabs",{staticClass:"mt",attrs:{type:"border-card"},on:{"tab-click":t.changeTab}},[i("el-tab-pane",{attrs:{label:"动态参数"}},[i("el-button",{attrs:{type:"primary",size:"mini",disabled:!t.flag},on:{click:t.add}},[t._v("添加参数")]),i("el-table",{staticClass:"mt",staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",stripe:""}},[i("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(new Set(""==e.row.attr_vals?[]:e.row.attr_vals.split(",")),(function(l){return i("el-tag",{key:l,attrs:{closable:"","disable-transitions":!1},on:{close:function(i){return t.handleCloses(e.row,l)}}},[t._v(" "+t._s(l)+" ")])})),e.row.inputVisible?i("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:function(i){return t.handleInputConfirm(e.row)}},nativeOn:{keyup:function(i){return!i.type.indexOf("key")&&t._k(i.keyCode,"enter",13,i.key,"Enter")?null:t.handleInputConfirm(e.row)}},model:{value:e.row.inputTitle,callback:function(i){t.$set(e.row,"inputTitle",i)},expression:"scope.row.inputTitle"}}):i("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(i){return t.showInput(e.row)}}},[t._v("+ New Tag")])]}}])}),i("el-table-column",{attrs:{label:"#",type:"index",width:"50px"}}),i("el-table-column",{attrs:{label:"参数名称",prop:"attr_name"}}),i("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(i){return t.updates(e.row)}}},[t._v("修改")]),i("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(i){return t.del(e.row)}}},[t._v("删除")])]}}])})],1)],1),i("el-tab-pane",{attrs:{label:"静态属性"}},[i("el-button",{attrs:{type:"primary",size:"mini",disabled:!t.flag},on:{click:t.adds}},[t._v("添加属性")]),i("el-table",{staticClass:"mt",staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",stripe:""}},[i("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(new Set(""==e.row.attr_vals?[]:e.row.attr_vals.split(",")),(function(l){return i("el-tag",{key:l,attrs:{closable:"","disable-transitions":!1},on:{close:function(i){return t.handleCloses(e.row,l)}}},[t._v(" "+t._s(l)+" ")])})),e.row.inputVisible?i("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:function(i){return t.handleInputConfirm(e.row)}},nativeOn:{keyup:function(i){return!i.type.indexOf("key")&&t._k(i.keyCode,"enter",13,i.key,"Enter")?null:t.handleInputConfirm(e.row)}},model:{value:e.row.inputTitle,callback:function(i){t.$set(e.row,"inputTitle",i)},expression:"scope.row.inputTitle"}}):i("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(i){return t.showInput(e.row)}}},[t._v("+ New Tag")])]}}])}),i("el-table-column",{attrs:{label:"#",type:"index",width:"50px"}}),i("el-table-column",{attrs:{label:"属性名称",prop:"attr_name"}}),i("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(i){return t.updates(e.row)}}},[t._v("修改")]),i("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(i){return t.del(e.row)}}},[t._v("删除")])]}}])})],1)],1)],1),i("el-dialog",{attrs:{title:t.OneTitle,visible:t.dialogVisible,"before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:t.OneTitles,prop:"attr_name"}},[i("el-input",{model:{value:t.ruleForm.attr_name,callback:function(e){t.$set(t.ruleForm,"attr_name",e)},expression:"ruleForm.attr_name"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.out}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.ok}},[t._v("确 定")])],1)],1)],1)],1)},n=[],a=i(2348),s=i(2767),r={data(){return{options:[],value:[],flag:!1,sel:"many",tableData:[],OneTitle:"添加动态参数",OneTitles:"动态参数",ruleForm:{attr_name:""},dialogVisible:!1,rules:{attr_name:[{required:!0,message:"参数名称不能为空",trigger:"blur"},{min:1,max:16,message:"参数名称不能为空",trigger:"blur"}]},id:0,cid:0,attr_vals:"",dynamicTags:[],inputVisible:!1,inputValue:""}},methods:{updates(t){console.log(t),this.cid=t.cat_id,"many"==this.sel?(this.OneTitle="编辑动态参数",this.OneTitles="动态参数"):(this.OneTitle="编辑静态属性",this.OneTitles="静态属性"),this.id=t.attr_id,this.attr_vals=t.attr_vals,this.ruleForm.attr_name=t.attr_name,this.dialogVisible=!0},del(t){this.cid=t.cat_id,this.id=t.attr_id,this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{(0,s.V6)({id:this.id,cid:this.cid});this.handleChange(),this.$message({type:"success",message:"删除成功!"})})).catch((()=>{console.log("nothen"),this.$message({type:"info",message:"已取消删除"})}))},async send(){const t=await(0,s.m1)();this.options=t,console.log(t)},async handleChange(t){if(this.value.length<3)this.$message({message:"警告哦，这不是三级分类",type:"warning"}),console.log(this.value),this.tableData=[],this.value=[],this.flag=!1;else{this.flag=!0,console.log(this.sel);const t=await(0,s.Wd)({id:1*this.value[this.value.length-1],sel:this.sel});console.log(t),t.forEach((t=>{t.inputVisible=!1,t.inputTitle=""})),this.tableData=t}},add(){this.title=!0,this.sel="many",this.dialogVisible=!0,"many"==this.sel?(this.OneTitle="编辑动态参数",this.OneTitles="动态参数"):(this.OneTitle="编辑静态属性",this.OneTitles="静态属性"),this.OneTitle="添加动态参数"},adds(){this.title=!1,this.sel="only",this.dialogVisible=!0,this.OneTitle="添加静态属性",this.OneTitles="静态属性"},ok(){this.$refs.ruleForm.validate((async t=>{if("编辑动态参数"==this.OneTitle){console.log(this.id,this.cid,this.ruleForm.attr_name,this.sel,this.attr_vals);await(0,s.gg)({id:this.id,cid:this.cid,attr_name:this.ruleForm.attr_name,attr_sel:this.sel,attr_vals:this.attr_vals});this.handleChange(),this.dialogVisible=!1,this.ruleForm.attr_name=""}else{if(!t)return console.log("error submit!!"),this.ruleForm.attr_name="",!1;{console.log(this.value[this.value.length-1],this.ruleForm.attr_name,this.sel);const t=await(0,s.UY)({id:this.value[this.value.length-1],attr_name:this.ruleForm.attr_name,attr_sel:this.sel});console.log(t),this.handleChange(),this.dialogVisible=!1,this.ruleForm.attr_name=""}}}))},out(){this.$refs.ruleForm.resetFields(),this.dialogVisible=!1},handleClose(t){this.$confirm("确认关闭？").then((e=>{t()})).catch((t=>{}))},showInput(t){console.log(t),t.inputVisible=!0,this.$nextTick((t=>{this.$refs.saveTagInput.$refs.input.focus()}))},async handleCloses(t,e){let i=t.attr_vals.split(","),l=i.findIndex((t=>t==e));console.log(t,e),console.log(l),console.log(t.attr_vals,i),i.splice(l,1),console.log(i);const n=await(0,s.gg)({cid:t.cat_id,id:t.attr_id,attr_name:t.attr_name,attr_sel:this.sel,attr_vals:i.join(",")});console.log(n),t.attr_vals=n.attr_vals},async handleInputConfirm(t){if(console.log(t),t.inputTitle){if(0==t.attr_vals.trim().length)var e=[t.inputTitle];else e=[...t.attr_vals.split(","),t.inputTitle];console.log(e);const i=await(0,s.gg)({cid:t.cat_id,id:t.attr_id,attr_name:t.attr_name,attr_sel:this.sel,attr_vals:e.join(",")});console.log(i),t.attr_vals=i.attr_vals,console.log(t)}t.inputVisible=!1,t.inputTitle=""},async changeTab(t){if(console.log(t.index),0==this.value.length)return this.$message({message:"警告哦，还没选三级分类呢",type:"warning"}),!1;if(0==t.index){this.sel="many",this.OneTitle="编辑动态参数";const t=await(0,s.Wd)({id:1*this.value[this.value.length-1],sel:this.sel});console.log(t),t.forEach((t=>{t.inputVisible=!1,t.inputTitle=""})),this.tableData=t}else if(1==t.index){this.sel="only",this.OneTitle="编辑静态属性",this.OneTitles="静态属性";const t=await(0,s.Wd)({id:1*this.value[this.value.length-1],sel:this.sel});console.log(t),t.forEach((t=>{t.inputVisible=!1,t.inputTitle=""})),this.tableData=t}}},components:{MBX:a.Z},computed:{},watch:{},created(){this.send()}},o=r,u=i(1001),c=(0,u.Z)(o,l,n,!1,null,"efe83474",null),d=c.exports},2767:function(t,e,i){i.d(e,{$K:function(){return s},Ce:function(){return n},NL:function(){return r},UY:function(){return c},V6:function(){return h},Wd:function(){return u},Yp:function(){return f},cD:function(){return m},g_:function(){return o},gg:function(){return d},m1:function(){return a},ol:function(){return g},yr:function(){return p}});var l=i(1899);function n(t){return(0,l.Z)({url:"goods",method:"GET",params:t})}function a(t){return(0,l.Z)({url:"categories",method:"GET",params:t})}function s(t){return(0,l.Z)({url:"categories",method:"POST",data:t})}function r(t){return(0,l.Z)({url:"categories/"+t.id,method:"PUT",data:t})}function o(t){return(0,l.Z)({url:"categories/"+t,method:"DELETE"})}function u(t){return(0,l.Z)({url:"categories/"+t.id+"/attributes",method:"GET",params:t})}function c(t){return(0,l.Z)({url:"categories/"+t.id+"/attributes",method:"POST",data:t})}function d(t){return(0,l.Z)({url:"categories/"+t.cid+"/attributes/"+t.id,method:"PUT",data:t})}function h(t){return console.log(t),(0,l.Z)({url:"categories/"+t.cid+"/attributes/"+t.id,method:"DELETE"})}function m(t){return(0,l.Z)({url:"goods/",method:"POST",data:t})}function p(t){return(0,l.Z)({url:"goods/"+1*t.goods_id,method:"PUT",data:t})}function f(t){return(0,l.Z)({url:"goods/"+t,method:"DELETE"})}function g(t){return(0,l.Z)({url:"goods/"+t.id,method:"GET"})}}}]);
//# sourceMappingURL=898.0041efa7.js.map