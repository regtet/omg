"use strict";(self["webpackChunklike"]=self["webpackChunklike"]||[]).push([[236],{4908:function(e,t,r){r.r(t),r.d(t,{default:function(){return m}});var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"roles"},[r("MBX",{attrs:{label1:"权限管理",label2:"角色列表"}}),r("el-card",[r("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("添加角色")]),[r("el-table",{staticClass:"mt",staticStyle:{width:"100%"},attrs:{border:"",data:e.tableData}},[r("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticClass:"box"},[e._l(t.row.children,(function(n){return r("el-row",{key:n.id,staticStyle:{border:"1px solid #e9e9e9"},attrs:{border:""}},[r("el-col",{attrs:{span:5}},[r("div",{staticClass:"grid-content bg-purple"},[r("el-tag",{attrs:{closable:"",type:"",effect:"dark"},on:{close:function(r){return e.close(n.id,t.row)}}},[e._v(" "+e._s(n.authName)+" ")]),r("i",{staticClass:"el-icon-caret-right"})],1)]),r("el-col",{attrs:{span:19}},e._l(n.children,(function(n){return r("el-row",{key:n.id,staticStyle:{border:"1px solid #e9e9e9"},attrs:{border:""}},[r("el-col",{attrs:{span:6}},[r("div",{staticClass:"grid-content bg-purple"},[r("el-tag",{attrs:{closable:"",type:"success",effect:"dark"},on:{close:function(r){return e.close(n.id,t.row)}}},[e._v(" "+e._s(n.authName)+" ")]),r("i",{staticClass:"el-icon-caret-right"})],1)]),r("el-col",{attrs:{span:18}},e._l(n.children,(function(n){return r("el-tag",{key:n.id,attrs:{closable:"",type:"warning",effect:"dark"},on:{close:function(r){return e.close(n.id,t.row)}}},[e._v(" "+e._s(n.authName)+" ")])})),1)],1)})),1)],1)})),r("el-empty",{directives:[{name:"show",rawName:"v-show",value:0==t.row.children.length,expression:"scope.row.children.length == 0"}],attrs:{image:"/ali0.png",description:"暂无数据"}})],2)]}}])}),r("el-table-column",{attrs:{type:"index",label:"#"}}),r("el-table-column",{attrs:{prop:"roleName",label:"角色名称"}}),r("el-table-column",{attrs:{prop:"roleDesc",label:"角色描述"}}),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(r){return e.updates(t.row)}}},[e._v("编辑")]),r("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(r){return e.del(t.row)}}},[e._v("删除")]),r("el-button",{attrs:{size:"mini",type:"warning",icon:"el-icon-s-tools"},on:{click:function(r){return e.set(t.row)}}},[e._v("分配权限")])]}}])})],1)],r("el-dialog",{attrs:{title:0==e.title?"添加角色":1==e.title?"编辑角色":"分配权限",visible:e.dialogVisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{directives:[{name:"show",rawName:"v-show",value:2!=e.title,expression:"title != 2"}],ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[r("el-input",{model:{value:e.ruleForm.roleName,callback:function(t){e.$set(e.ruleForm,"roleName",t)},expression:"ruleForm.roleName"}})],1),r("el-form-item",{attrs:{label:"角色描述",prop:"roleDesc"}},[r("el-input",{model:{value:e.ruleForm.roleDesc,callback:function(t){e.$set(e.ruleForm,"roleDesc",t)},expression:"ruleForm.roleDesc"}})],1)],1),r("el-tree",{directives:[{name:"show",rawName:"v-show",value:2==e.title,expression:"title == 2"}],ref:"tree",attrs:{data:e.treeData,"show-checkbox":"","node-key":"id","default-expand-all":"","default-checked-keys":e.checkArr,props:e.defaultProps}}),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.out}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.adds}},[e._v("确 定")])],1)],1)],2)],1)},o=[],i=r(4479),s=r(6198),l=(r(8862),r(1539),r(4747),r(4660),r(9600),r(5666),r(2348)),a=r(2552),u={data:function(){return{tableData:[{date:"2016-05-02",name:"王小虎",address:"上海市普陀区金沙江路 1518 弄"}],dialogVisible:!1,ruleForm:{roleName:"",roleDesc:""},title:0,rules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:2,max:8,message:"角色名称长度在2~8个字符之间",trigger:"blur"}],roleDesc:[{required:!0,message:"请输入角色描述",trigger:"blur"},{message:"请输入角色描述",trigger:"blur"}]},treeData:[],defaultProps:{children:"children",label:"authName"},checkArr:[],id:0}},methods:{send:function(){var e=this;return(0,s.Z)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,a.G7)();case 2:r=t.sent,console.log(r),e.tableData=r;case 5:case"end":return t.stop()}}),t)})))()},updates:function(e){console.log(e),this.title=1,this.dialogVisible=!0,this.ruleForm=JSON.parse(JSON.stringify(e))},set:function(e){var t=this;return(0,s.Z)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return console.log(e),t.id=e.id,t.checkArr=[],t.getArr(e.children,t.checkArr),t.title=2,t.dialogVisible=!0,r.next=8,(0,a.Mo)({type:"tree"});case 8:n=r.sent,t.treeData=n;case 10:case"end":return r.stop()}}),r)})))()},getArr:function(e,t){var r=this;e.forEach((function(e){e.children?r.getArr(e.children,r.checkArr):r.checkArr.push(e.id)}))},del:function(e){var t=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((0,s.Z)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,(0,a.BL)({id:e.id});case 2:r.sent,t.send(),t.$message({type:"success",message:"删除成功!"});case 5:case"end":return r.stop()}}),r)})))).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},add:function(){console.log(this.$refs.ruleForm),this.dialogVisible=!0,this.ruleForm={},this.title=0},out:function(){if(this.dialogVisible=!1,2==this.title)return!1;this.$refs.ruleForm.resetFields()},adds:function(){var e=this;return(0,s.Z)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$refs.ruleForm.validate(function(){var t=(0,s.Z)(regeneratorRuntime.mark((function t(r){var n,o,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=17;break}if(0!=e.title){t.next=7;break}return t.next=4,(0,a.lf)(e.ruleForm);case 4:t.sent,t.next=12;break;case 7:if(1!=e.title){t.next=12;break}return n=e.ruleForm,o=n.id,i=n.roleName,s=n.roleDesc,t.next=11,(0,a.BM)({id:o,roleName:i,roleDesc:s});case 11:t.sent;case 12:e.$refs.ruleForm.resetFields(),e.send(),e.dialogVisible=!1,t.next=19;break;case 17:return console.log("error submit!!"),t.abrupt("return",!1);case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),2!=e.title){t.next=8;break}return r=[].concat((0,i.Z)(e.$refs.tree.getCheckedKeys()),(0,i.Z)(e.$refs.tree.getHalfCheckedKeys())),t.next=5,(0,a.rp)({id:e.id,rids:r.join(",")});case 5:t.sent,e.dialogVisible=!1,e.send();case 8:case"end":return t.stop()}}),t)})))()},handleClose:function(e){this.$confirm("确认关闭？").then((function(t){e()})).catch((function(e){}))},close:function(e,t){var r=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((0,s.Z)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,a.c4)({rightId:e,roleId:t.id});case 2:o=n.sent,console.log(o),console.log(t),t.children=o,r.$message({type:"success",message:"删除成功!"});case 7:case"end":return n.stop()}}),n)})))).catch((function(){r.$message({type:"info",message:"已取消删除"})}))}},components:{MBX:l.Z},computed:{},watch:{},created:function(){this.send()}},c=u,d=r(1001),f=(0,d.Z)(c,n,o,!1,null,"a623d56a",null),m=f.exports},2552:function(e,t,r){r.d(t,{Aq:function(){return w},BL:function(){return g},BM:function(){return p},FZ:function(){return l},G7:function(){return m},GJ:function(){return s},Ig:function(){return o},Mo:function(){return f},ZM:function(){return c},bJ:function(){return i},c4:function(){return v},lf:function(){return h},o9:function(){return a},rp:function(){return b},uq:function(){return d},v6:function(){return u}});var n=r(1899);function o(e){return(0,n.Z)({url:"login",method:"POST",data:e})}function i(){return(0,n.Z)({url:"menus",method:"GET"})}function s(e){return(0,n.Z)({url:"users",method:"GET",params:e})}function l(e){return(0,n.Z)({url:"users",method:"POST",data:e})}function a(e){return(0,n.Z)({url:"users/"+e.id,method:"PUT",data:e})}function u(e){return(0,n.Z)({url:"users/"+e.id,method:"DELETE"})}function c(e){return(0,n.Z)({url:"users/"+e.id+"/state/"+e.type,method:"PUT"})}function d(e){return(0,n.Z)({url:"users/"+e.id+"/role/",method:"PUT",data:e})}function f(e){return(0,n.Z)({url:"rights/"+e.type,method:"GET"})}function m(){return(0,n.Z)({url:"roles/",method:"GET"})}function h(e){return(0,n.Z)({url:"roles/",method:"POST",data:e})}function p(e){return(0,n.Z)({url:"roles/"+e.id,method:"PUT",data:e})}function g(e){return(0,n.Z)({url:"roles/"+e.id,method:"DELETE"})}function b(e){return(0,n.Z)({url:"roles/"+e.id+"/rights",method:"POST",data:e})}function v(e){return(0,n.Z)({url:"roles/"+e.roleId+"/rights/"+e.rightId,method:"DELETE"})}function w(e){return(0,n.Z)({url:"reports/type/1",method:"GET"})}}}]);
//# sourceMappingURL=236-legacy.95a7e29f.js.map