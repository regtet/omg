"use strict";(self["webpackChunklike"]=self["webpackChunklike"]||[]).push([[236],{2348:function(e,t,r){r.d(t,{Z:function(){return c}});var l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/stimulate"}}},[e._v("首页")]),r("el-breadcrumb-item",[e._v(e._s(e.label1))]),r("el-breadcrumb-item",[e._v(e._s(e.label2))])],1)],1)},s=[],i={props:["label1","label2"],data(){return{}},methods:{},components:{},computed:{},watch:{},created(){}},o=i,n=r(1001),a=(0,n.Z)(o,l,s,!1,null,"cda8670e",null),c=a.exports},4908:function(e,t,r){r.r(t),r.d(t,{default:function(){return d}});var l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"roles"},[r("MBX",{attrs:{label1:"权限管理",label2:"角色列表"}}),r("el-card",[r("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("添加角色")]),[r("el-table",{staticClass:"mt",staticStyle:{width:"100%"},attrs:{border:"",data:e.tableData}},[r("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticClass:"box"},[e._l(t.row.children,(function(l){return r("el-row",{key:l.id,staticStyle:{border:"1px solid #e9e9e9"},attrs:{border:""}},[r("el-col",{attrs:{span:5}},[r("div",{staticClass:"grid-content bg-purple"},[r("el-tag",{attrs:{closable:"",type:"",effect:"dark"},on:{close:function(r){return e.close(l.id,t.row)}}},[e._v(" "+e._s(l.authName)+" ")]),r("i",{staticClass:"el-icon-caret-right"})],1)]),r("el-col",{attrs:{span:19}},e._l(l.children,(function(l){return r("el-row",{key:l.id,staticStyle:{border:"1px solid #e9e9e9"},attrs:{border:""}},[r("el-col",{attrs:{span:6}},[r("div",{staticClass:"grid-content bg-purple"},[r("el-tag",{attrs:{closable:"",type:"success",effect:"dark"},on:{close:function(r){return e.close(l.id,t.row)}}},[e._v(" "+e._s(l.authName)+" ")]),r("i",{staticClass:"el-icon-caret-right"})],1)]),r("el-col",{attrs:{span:18}},e._l(l.children,(function(l){return r("el-tag",{key:l.id,attrs:{closable:"",type:"warning",effect:"dark"},on:{close:function(r){return e.close(l.id,t.row)}}},[e._v(" "+e._s(l.authName)+" ")])})),1)],1)})),1)],1)})),r("el-empty",{directives:[{name:"show",rawName:"v-show",value:0==t.row.children.length,expression:"scope.row.children.length == 0"}],attrs:{image:"/ali0.png",description:"暂无数据"}})],2)]}}])}),r("el-table-column",{attrs:{type:"index",label:"#"}}),r("el-table-column",{attrs:{prop:"roleName",label:"角色名称"}}),r("el-table-column",{attrs:{prop:"roleDesc",label:"角色描述"}}),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(r){return e.updates(t.row)}}},[e._v("编辑")]),r("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(r){return e.del(t.row)}}},[e._v("删除")]),r("el-button",{attrs:{size:"mini",type:"warning",icon:"el-icon-s-tools"},on:{click:function(r){return e.set(t.row)}}},[e._v("分配权限")])]}}])})],1)],r("el-dialog",{attrs:{title:0==e.title?"添加角色":1==e.title?"编辑角色":"分配权限",visible:e.dialogVisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{directives:[{name:"show",rawName:"v-show",value:2!=e.title,expression:"title != 2"}],ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[r("el-input",{model:{value:e.ruleForm.roleName,callback:function(t){e.$set(e.ruleForm,"roleName",t)},expression:"ruleForm.roleName"}})],1),r("el-form-item",{attrs:{label:"角色描述",prop:"roleDesc"}},[r("el-input",{model:{value:e.ruleForm.roleDesc,callback:function(t){e.$set(e.ruleForm,"roleDesc",t)},expression:"ruleForm.roleDesc"}})],1)],1),r("el-tree",{directives:[{name:"show",rawName:"v-show",value:2==e.title,expression:"title == 2"}],ref:"tree",attrs:{data:e.treeData,"show-checkbox":"","node-key":"id","default-expand-all":"","default-checked-keys":e.checkArr,props:e.defaultProps}}),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.out}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.adds}},[e._v("确 定")])],1)],1)],2)],1)},s=[],i=r(2348),o=r(2552),n={data(){return{tableData:[{date:"2016-05-02",name:"王小虎",address:"上海市普陀区金沙江路 1518 弄"}],dialogVisible:!1,ruleForm:{roleName:"",roleDesc:""},title:0,rules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:2,max:8,message:"角色名称长度在2~8个字符之间",trigger:"blur"}],roleDesc:[{required:!0,message:"请输入角色描述",trigger:"blur"},{message:"请输入角色描述",trigger:"blur"}]},treeData:[],defaultProps:{children:"children",label:"authName"},checkArr:[],id:0}},methods:{async send(){const e=await(0,o.G7)();console.log(e),this.tableData=e},updates(e){console.log(e),this.title=1,this.dialogVisible=!0,this.ruleForm=JSON.parse(JSON.stringify(e))},async set(e){console.log(e),this.id=e.id,this.checkArr=[],this.getArr(e.children,this.checkArr),this.title=2,this.dialogVisible=!0;const t=await(0,o.Mo)({type:"tree"});this.treeData=t},getArr(e,t){e.forEach((e=>{e.children?this.getArr(e.children,this.checkArr):this.checkArr.push(e.id)}))},del(e){this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{await(0,o.BL)({id:e.id});this.send(),this.$message({type:"success",message:"删除成功!"})})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},add(){console.log(this.$refs.ruleForm),this.dialogVisible=!0,this.ruleForm={},this.title=0},out(){if(this.dialogVisible=!1,2==this.title)return!1;this.$refs.ruleForm.resetFields()},async adds(){if(this.$refs.ruleForm.validate((async e=>{if(!e)return console.log("error submit!!"),!1;if(0==this.title){await(0,o.lf)(this.ruleForm)}else if(1==this.title){const{id:e,roleName:t,roleDesc:r}=this.ruleForm;await(0,o.BM)({id:e,roleName:t,roleDesc:r})}this.$refs.ruleForm.resetFields(),this.send(),this.dialogVisible=!1})),2==this.title){let e=[...this.$refs.tree.getCheckedKeys(),...this.$refs.tree.getHalfCheckedKeys()];await(0,o.rp)({id:this.id,rids:e.join(",")});this.dialogVisible=!1,this.send()}},handleClose(e){this.$confirm("确认关闭？").then((t=>{e()})).catch((e=>{}))},close(e,t){this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const r=await(0,o.c4)({rightId:e,roleId:t.id});console.log(r),console.log(t),t.children=r,this.$message({type:"success",message:"删除成功!"})})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))}},components:{MBX:i.Z},computed:{},watch:{},created(){this.send()}},a=n,c=r(1001),u=(0,c.Z)(a,l,s,!1,null,"a623d56a",null),d=u.exports},2552:function(e,t,r){r.d(t,{Aq:function(){return w},BL:function(){return b},BM:function(){return p},FZ:function(){return n},G7:function(){return m},GJ:function(){return o},Ig:function(){return s},Mo:function(){return h},ZM:function(){return u},bJ:function(){return i},c4:function(){return y},lf:function(){return f},o9:function(){return a},rp:function(){return g},uq:function(){return d},v6:function(){return c}});var l=r(1899);function s(e){return(0,l.Z)({url:"login",method:"POST",data:e})}function i(){return(0,l.Z)({url:"menus",method:"GET"})}function o(e){return(0,l.Z)({url:"users",method:"GET",params:e})}function n(e){return(0,l.Z)({url:"users",method:"POST",data:e})}function a(e){return(0,l.Z)({url:"users/"+e.id,method:"PUT",data:e})}function c(e){return(0,l.Z)({url:"users/"+e.id,method:"DELETE"})}function u(e){return(0,l.Z)({url:"users/"+e.id+"/state/"+e.type,method:"PUT"})}function d(e){return(0,l.Z)({url:"users/"+e.id+"/role/",method:"PUT",data:e})}function h(e){return(0,l.Z)({url:"rights/"+e.type,method:"GET"})}function m(){return(0,l.Z)({url:"roles/",method:"GET"})}function f(e){return(0,l.Z)({url:"roles/",method:"POST",data:e})}function p(e){return(0,l.Z)({url:"roles/"+e.id,method:"PUT",data:e})}function b(e){return(0,l.Z)({url:"roles/"+e.id,method:"DELETE"})}function g(e){return(0,l.Z)({url:"roles/"+e.id+"/rights",method:"POST",data:e})}function y(e){return(0,l.Z)({url:"roles/"+e.roleId+"/rights/"+e.rightId,method:"DELETE"})}function w(e){return(0,l.Z)({url:"reports/type/1",method:"GET"})}}}]);
//# sourceMappingURL=236.bcc644d0.js.map