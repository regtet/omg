"use strict";(self["webpackChunklike"]=self["webpackChunklike"]||[]).push([[439],{9355:function(e,t,r){r.r(t),r.d(t,{default:function(){return p}});var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"users"},[r("MBX",{attrs:{label1:"用户管理",label2:"用户列表"}}),r("el-card",[r("el-input",{staticClass:"input-with-select",staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容",clearable:""},on:{clear:e.clear,input:e.input},model:{value:e.current.query,callback:function(t){e.$set(e.current,"query",t)},expression:"current.query"}},[r("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1),r("el-button",{staticClass:"ml",attrs:{type:"primary"},on:{click:e.add}},[e._v("添加用户")]),[r("el-table",{staticClass:"mt",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",stripe:""}},[r("el-table-column",{attrs:{type:"index",label:"#",width:"50"}}),r("el-table-column",{attrs:{prop:"username",label:"姓名",width:"180"}}),r("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),r("el-table-column",{attrs:{prop:"mobile",label:"电话"}}),r("el-table-column",{attrs:{prop:"role_name",label:"角色"}}),r("el-table-column",{attrs:{prop:"mg_state",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{on:{change:function(r){return e.change(t.row)}},model:{value:t.row.mg_state,callback:function(r){e.$set(t.row,"mg_state",r)},expression:"scope.row.mg_state"}})]}}])}),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(r){return e.updates(t.row)}}}),r("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(r){return e.del(t.row)}}}),r("el-button",{attrs:{size:"mini",type:"warning",icon:"el-icon-s-tools"},on:{click:function(r){return e.set(t.row)}}})]}}])})],1)],r("div",{staticClass:"block mt"},[r("el-pagination",{attrs:{"current-page":e.current.pagenum,"page-sizes":[3,5,8,10],"page-size":e.current.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{attrs:{title:0==e.title?"添加用户":1==e.title?"编辑用户":"分配角色",visible:e.dialogVisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{directives:[{name:"show",rawName:"v-show",value:2!=e.title,expression:"title != 2"}],ref:"form",staticClass:"demo-ruleForm",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{attrs:{disabled:1==e.title},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),0==e.title?r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1):e._e(),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),r("el-form-item",{attrs:{label:"电话",prop:"mobile"}},[r("el-input",{model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1)],1),r("div",{directives:[{name:"show",rawName:"v-show",value:2==e.title,expression:"title == 2"}]},[r("li",[e._v("当前的用户 : "+e._s(e.userBox.username))]),r("li",{staticClass:"mt"},[e._v("当前的角色 : "+e._s(e.userBox.role_name))]),r("div",{staticClass:"mt"},[e._v(" 分配新角色 : "),r("el-cascader",{attrs:{options:e.options,props:e.defaultParams},on:{change:e.handleChange},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)]),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")])],1)],1)],2)],1)},a=[],i=r(6198),s=(r(8862),r(5666),r(6486)),o=r.n(s),l=r(2552),u=r(2348),c={data:function(){return{title:0,_:o(),form:{username:"",password:"",email:"",mobile:""},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:15,message:"长度在6 到 15 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/^(?![\d]+$)(?![a-zA-Z]+$)(?![^\da-zA-Z]+$)([^\u4e00-\u9fa5\s]){6,20}$/,message:"请输入6-20位英文字母、数字或者符号（除空格），且字母、数字和标点符号至少包含两种",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{pattern:/^([a-zA-Z0-9]+[-_\.]?)+@[a-zA-Z0-9]+\.[a-z]+$/,message:"请输入正确的邮箱",trigger:"blur"}],mobile:[{required:!0,message:"请输入电话号码",trigger:"blur"},{pattern:/^[1][3-9][0-9]{9}$/,message:"请输入正确的电话号码",trigger:"blur"}]},tableData:[],tableDataS:[],current:{query:"",pagenum:1,pagesize:3},total:10,dialogVisible:!1,id:0,userBox:{},value:[],options:[{value:"zhinan",label:"指南"}],defaultParams:{label:"roleName",value:"id",children:""}}},methods:{input:o().debounce((function(){this.send()}),300),send:function(){var e=this;return(0,i.Z)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,l.GJ)(e.current);case 2:r=t.sent,e.current.pagenum=r.pagenum,e.total=r.total,e.tableData=r.users,e.tableDataS=e.tableData;case 7:case"end":return t.stop()}}),t)})))()},add:function(){this.form={},this.dialogVisible=!0,this.title=0,this.$refs.form&&this.$refs.form.resetFields()},submitForm:function(){var e=this;return(0,i.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(2!=e.title){t.next=10;break}if(500!=e.id){t.next=4;break}return e.$message({type:"info",message:"不允许修改admin"}),t.abrupt("return",!1);case 4:return t.next=6,(0,l.uq)({id:e.id,rid:e.value[0]});case 6:return t.sent,e.dialogVisible=!1,e.send(),t.abrupt("return",!1);case 10:e.$refs.form.validate(function(){var t=(0,i.Z)(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=13;break}if(0!=e.title){t.next=9;break}return t.next=4,(0,l.FZ)(e.form);case 4:t.sent,e.dialogVisible=!1,e.send(),t.next=11;break;case 9:console.log(e.form),(0,l.o9)({id:e.id,email:e.form.email,mobile:e.form.mobile}).then((function(t){e.dialogVisible=!1,e.send()}));case 11:t.next=14;break;case 13:return t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 11:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.current.pagesize=e,this.send()},handleCurrentChange:function(e){this.current.pagenum=e,this.send()},handleClose:function(e){this.$confirm("确认关闭？").then((function(t){e()})).catch((function(e){}))},updates:function(e){this.$refs.form&&this.$refs.form.resetFields(),this.id=e.id,this.dialogVisible=!0,this.title=1,this.form=JSON.parse(JSON.stringify(e)),console.log(this.form)},del:function(e){var t=this;this.id=e.id,this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,l.v6)({id:t.id});case 2:e.sent,t.send();case 4:case"end":return e.stop()}}),e)})))).catch((function(){t.$message({type:"warning",message:"已取消删除"})}))},set:function(e){var t=this;return(0,i.Z)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.id=e.id,r.next=3,(0,l.G7)();case 3:n=r.sent,t.options=n,t.title=2,t.dialogVisible=!0,t.userBox=e;case 8:case"end":return r.stop()}}),r)})))()},search:function(){},clear:function(){this.send()},change:function(e){var t=this;return(0,i.Z)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return console.log(e),r.next=3,(0,l.ZM)({id:e.id,type:e.mg_state});case 3:r.sent,t.send();case 5:case"end":return r.stop()}}),r)})))()},handleChange:function(e){this.value=e}},components:{MBX:u.Z},computed:{},watch:{},created:function(){this.send()}},m=c,d=r(1001),f=(0,d.Z)(m,n,a,!1,null,"2b1a85eb",null),p=f.exports},2552:function(e,t,r){r.d(t,{Aq:function(){return w},BL:function(){return g},BM:function(){return h},FZ:function(){return o},G7:function(){return f},GJ:function(){return s},Ig:function(){return a},Mo:function(){return d},ZM:function(){return c},bJ:function(){return i},c4:function(){return v},lf:function(){return p},o9:function(){return l},rp:function(){return b},uq:function(){return m},v6:function(){return u}});var n=r(1899);function a(e){return(0,n.Z)({url:"login",method:"POST",data:e})}function i(){return(0,n.Z)({url:"menus",method:"GET"})}function s(e){return(0,n.Z)({url:"users",method:"GET",params:e})}function o(e){return(0,n.Z)({url:"users",method:"POST",data:e})}function l(e){return(0,n.Z)({url:"users/"+e.id,method:"PUT",data:e})}function u(e){return(0,n.Z)({url:"users/"+e.id,method:"DELETE"})}function c(e){return(0,n.Z)({url:"users/"+e.id+"/state/"+e.type,method:"PUT"})}function m(e){return(0,n.Z)({url:"users/"+e.id+"/role/",method:"PUT",data:e})}function d(e){return(0,n.Z)({url:"rights/"+e.type,method:"GET"})}function f(){return(0,n.Z)({url:"roles/",method:"GET"})}function p(e){return(0,n.Z)({url:"roles/",method:"POST",data:e})}function h(e){return(0,n.Z)({url:"roles/"+e.id,method:"PUT",data:e})}function g(e){return(0,n.Z)({url:"roles/"+e.id,method:"DELETE"})}function b(e){return(0,n.Z)({url:"roles/"+e.id+"/rights",method:"POST",data:e})}function v(e){return(0,n.Z)({url:"roles/"+e.roleId+"/rights/"+e.rightId,method:"DELETE"})}function w(e){return(0,n.Z)({url:"reports/type/1",method:"GET"})}}}]);
//# sourceMappingURL=439-legacy.4b2073a2.js.map